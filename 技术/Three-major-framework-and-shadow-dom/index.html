<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="UTF-8"><meta name="renderer" content="webkit"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"><title>浅谈Vue,React,Angular三大框架与shadow dom 的关系徐凯的博客</title><link rel="stylesheet" href="https://cdn.bootcss.com/material-components-web/2.3.1/material-components-web.min.css"><link rel="stylesheet" href="/css/common.css"></head><body><aside class="mdc-drawer mdc-drawer--modal"><div class="mdc-drawer__header mdc-ripple-surface avatar-card" data-mdc-auto-init="MDCRipple"><img class="avatar" src="/img/avatar.png" alt><div> <h3 class="mdc-drawer__title">徐凯</h3><h6 class="mdc-drawer__subtitle">xukai@email.com</h6></div></div><div class="mdc-drawer__content">       <div class="mdc-list site-menu"><div class="categories-menu"><hr class="mdc-list-divider"><h6 class="mdc-list-group__subheader">分类</h6><a class="mdc-list-item mdc-list-item--activated" href="/categories/杂谈" data-mdc-auto-init="MDCRipple"><i class="material-icons mdc-list-item__graphic" aria-hidden="true">inbox</i><span class="mdc-list-item__text">杂谈</span></a><a class="mdc-list-item mdc-list-item--activated" href="/categories/技术" data-mdc-auto-init="MDCRipple"><i class="material-icons mdc-list-item__graphic" aria-hidden="true">inbox</i><span class="mdc-list-item__text">技术</span></a><a class="mdc-list-item mdc-list-item--activated" href="/categories/test" data-mdc-auto-init="MDCRipple"><i class="material-icons mdc-list-item__graphic" aria-hidden="true">inbox</i><span class="mdc-list-item__text">test</span></a></div><div class="theme-menu"><hr class="mdc-list-divider"><h6 class="mdc-list-group__subheader">导航</h6><a class="mdc-list-item mdc-list-item--activated" href="/" data-mdc-auto-init="MDCRipple"><i class="material-icons mdc-list-item__graphic" aria-hidden="true">inbox</i><span class="mdc-list-item__text">Home</span></a><a class="mdc-list-item mdc-list-item--activated" href="/about" data-mdc-auto-init="MDCRipple"><i class="material-icons mdc-list-item__graphic" aria-hidden="true">inbox</i><span class="mdc-list-item__text">About</span></a><a class="mdc-list-item mdc-list-item--activated" href="/archives" data-mdc-auto-init="MDCRipple"><i class="material-icons mdc-list-item__graphic" aria-hidden="true">inbox</i><span class="mdc-list-item__text">Archives</span></a></div></div></div></aside><div class="mdc-drawer-scrim"></div><header class="mdc-top-app-bar" id="app-bar"><div class="mdc-top-app-bar__row"><section class="mdc-top-app-bar__section mdc-top-app-bar__section--align-start"><a class="material-icons mdc-top-app-bar__navigation-icon" href="#">menu</a><span class="mdc-top-app-bar__title">徐凯的博客</span></section><nav class="blog-nav"><div class="nav-surface mdc-ripple-surface" data-mdc-auto-init="MDCRipple">           <a href="/">首页</a></div><div class="nav-surface mdc-ripple-surface" data-mdc-auto-init="MDCRipple">           <a href="/about">关于</a></div><div class="nav-surface mdc-ripple-surface" data-mdc-auto-init="MDCRipple">           <a href="/archives">归档</a></div></nav></div></header><div id="content-outer"><div id="content-inner"><div class="main-post"><article id="post"><h1>浅谈Vue,React,Angular三大框架与shadow dom 的关系</h1><h6 class="mdc-typography--subtitle1 row"><div class="post-data"><i class="material-icons mdc-chip__icon mdc-chip__icon--leading">date_range </i><span>2018-06-19</span></div><div class="post-tags"><i class="material-icons mdc-chip__icon mdc-chip__icon--leading">local_offer          </i><a href="/tags/vue/">vue</a><a href="/tags/react/">react</a><a href="/tags/angular/">angular</a><a href="/tags/shadow-dom/">shadow-dom</a></div></h6><p>如果把前端还是美工的时期看作前端的刀耕火种时期，那么 jQuery 一把梭的时代可谓是一统天下了，正所谓天下代码，合久必分，分久必合，形成如今的三大框架三足鼎立正是合久必分的必然产物。</p>
<p>从前端的历史来看，jQuery 之所以出现，是因为浏览器厂商为占领市场份额，互不兼容，前端没有统一标准，存在大量兼容问题。参考中国历史上大国统一的关键就是统一衡量，那么解决前端兼容的唯一办法就是需要统一标准，而 jquery 的适时出现恰巧解决了这个最关键的问题，从而能够一统前端。</p>
<p>随着历史的车轮不断前进，jQuery 已经完成了它的历史使命，慢慢淡出前端第一梯队，由三大框架接力，继续推动这个车轮前进。</p>
<p>在我个人看来，如今的三大框架均是由数据驱动的前端模块化解决方案。虽然实现细节各有差异，但在解决问题的方向上是一致的，至于如何选择，就需结合团队及项目的经验等技术性和非技术性问题来决定。但从前端发展角度来看，这些肯定只是临时的最优解决方案，而且这几个框架也会相互借鉴优秀的功能实现，越来越同质化，未来肯定会出现一个统一的方案，结束这段三足鼎立史。</p>
<p>好了，上面随便侃一侃，不必当真，重点还是想谈一谈三大框架与前端模块化中 shadow dom 的一点小事情。</p>
<p>shadow dom 乍一听好像不太熟悉，但却是天天在我们眼皮子底下晃悠的东西。你有没有思考过这样的问题：<code>&lt;video&gt;&lt;/video&gt;</code>这个元素在不同的浏览器下有一定的差异，可是它为什么会长这个样子，为什么不会是其他的形状，大小？……</p>
<p>如你所愿，正是 shadow dom 赋予了它这个特殊的样式。当我们打开 chrome 的 DevTools ，按下 F1 之后勾选 Show user agent shadow DOM 选项，我们将在 Elements 面板下看到 shadow dom 的庐山真面目。那么这个东西到底有什么用呢？在搞懂这个问题之前，我们不妨先来做一个试试。</p>
<p>借助 <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/CustomElementRegistry" target="_blank" rel="noopener">CustomElementRegistry</a>接口,我们先随便做一个：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyTest</span> <span class="keyword">extends</span> <span class="title">HTMLElement</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>() &#123;</span><br><span class="line">    <span class="comment">// 这里必须要要调用super()，这个super()又是另一个话题了</span></span><br><span class="line">    <span class="keyword">super</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 开始创建我的第一个shadow dom</span></span><br><span class="line">    <span class="keyword">var</span> myShadow = <span class="keyword">this</span>.attachShadow(&#123;<span class="attr">mode</span>: <span class="string">'open'</span>&#125;);</span><br><span class="line"></span><br><span class="line">    myShadow.innerHTML=<span class="string">`</span></span><br><span class="line"><span class="string">    &lt;style&gt;</span></span><br><span class="line"><span class="string">    div &#123; </span></span><br><span class="line"><span class="string">        background-color: red;</span></span><br><span class="line"><span class="string">        color:blue;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">    &lt;/style&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &lt;div&gt; my first shadow dom &lt;/div&gt;</span></span><br><span class="line"><span class="string">    `</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">customElements.define(<span class="string">'my-test'</span>, MyTest);</span><br></pre></td></tr></table></figure>
<p>这样我们的第一个 shadow dom 就做成了，试着把它插入我们的文档，像这样 <code>&lt;my-test&gt;&lt;/my-test&gt;</code> ,刷新一下，就可以看到我们自定义的一个shadow dom 了，虽然长得有点辣眼睛。</p>
<p>到这里我们已经看到，这个东西和我们写的 react vue angular 的组件有点像（angular 已经在尝试使用shadow dom 模板了）。我们可以认为，三大框架他们的思想基石，都是来源于这里，只是实现方式略有不同。</p>
<p>同样，shadow dom 也有 slot 概念，和三大框架中基本一致，还有其他特性和相关说明，在<a href="https://www.w3.org/TR/2017/WD-shadow-dom-20170905" target="_blank" rel="noopener">w3c</a>这里可以查看。虽然这是原生支持的，但是目前兼容性还不太乐观，生产环境还是不建议使用的。</p>
<p>试想一下，当我们的浏览器未来将原生支持自定义组件，模块化…… ，前端将是怎样一种景象。现在回过头思考一下前面的问题，这个东西到底有什么作用？</p>
<p>我认为这个东西是前端的未来，是前端走向统一的必经之路，可能到时候会出现另外的 xx dom 或什么的，但和 shadow dom 的方向是一致的，肯定会带着前端走向统一。</p>
<div id="paginator"></div><span class="leancloud-visitors" id="技术/Three-major-framework-and-shadow-dom/index.html" data-flag-title="浅谈Vue,React,Angular三大框架与shadow dom 的关系"><em class="post-meta-item-text">阅读量 </em><i class="leancloud-visitors-count">1000000+</i></span><div id="valine"> </div></article><nav id="postnav"></nav></div></div></div><div id="bottom-outer"><h6 class="mdc-typography--subtitle1">©POWERED BY HEXO | THEME: XUKAI</h6><button class="mdc-fab" id="gotop" aria-label="arrow_upward" data-mdc-auto-init="MDCRipple"><span class="mdc-fab__icon material-icons">arrow_upward</span></button></div><script src="https://cdn.bootcss.com/material-components-web/2.3.1/material-components-web.min.js"></script><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="/js/Valine.min.js"></script><script src="/js/common.js"></script></body></html>