<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="UTF-8"><meta name="renderer" content="webkit"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"><title>Vue双向绑定的理解徐凯的博客</title><link rel="stylesheet" href="https://cdn.bootcss.com/material-components-web/2.3.1/material-components-web.min.css"><link rel="stylesheet" href="/css/common.css"></head><body><aside class="mdc-drawer mdc-drawer--modal"><div class="mdc-drawer__header mdc-ripple-surface avatar-card" data-mdc-auto-init="MDCRipple"><img class="avatar" src="/img/avatar.png" alt><div> <h3 class="mdc-drawer__title">徐凯</h3><h6 class="mdc-drawer__subtitle">xukai@email.com</h6></div></div><div class="mdc-drawer__content">       <div class="mdc-list site-menu"><div class="categories-menu"><hr class="mdc-list-divider"><h6 class="mdc-list-group__subheader">分类</h6><a class="mdc-list-item mdc-list-item--activated" href="/categories/杂谈" data-mdc-auto-init="MDCRipple"><i class="material-icons mdc-list-item__graphic" aria-hidden="true">inbox</i><span class="mdc-list-item__text">杂谈</span></a><a class="mdc-list-item mdc-list-item--activated" href="/categories/技术" data-mdc-auto-init="MDCRipple"><i class="material-icons mdc-list-item__graphic" aria-hidden="true">inbox</i><span class="mdc-list-item__text">技术</span></a><a class="mdc-list-item mdc-list-item--activated" href="/categories/test" data-mdc-auto-init="MDCRipple"><i class="material-icons mdc-list-item__graphic" aria-hidden="true">inbox</i><span class="mdc-list-item__text">test</span></a></div><div class="theme-menu"><hr class="mdc-list-divider"><h6 class="mdc-list-group__subheader">导航</h6><a class="mdc-list-item mdc-list-item--activated" href="/" data-mdc-auto-init="MDCRipple"><i class="material-icons mdc-list-item__graphic" aria-hidden="true">inbox</i><span class="mdc-list-item__text">Home</span></a><a class="mdc-list-item mdc-list-item--activated" href="/about" data-mdc-auto-init="MDCRipple"><i class="material-icons mdc-list-item__graphic" aria-hidden="true">inbox</i><span class="mdc-list-item__text">About</span></a><a class="mdc-list-item mdc-list-item--activated" href="/archives" data-mdc-auto-init="MDCRipple"><i class="material-icons mdc-list-item__graphic" aria-hidden="true">inbox</i><span class="mdc-list-item__text">Archives</span></a></div></div></div></aside><div class="mdc-drawer-scrim"></div><header class="mdc-top-app-bar" id="app-bar"><div class="mdc-top-app-bar__row"><section class="mdc-top-app-bar__section mdc-top-app-bar__section--align-start"><a class="material-icons mdc-top-app-bar__navigation-icon" href="#">menu</a><span class="mdc-top-app-bar__title">徐凯的博客</span></section><nav class="blog-nav"><div class="nav-surface mdc-ripple-surface" data-mdc-auto-init="MDCRipple">           <a href="/">首页</a></div><div class="nav-surface mdc-ripple-surface" data-mdc-auto-init="MDCRipple">           <a href="/about">关于</a></div><div class="nav-surface mdc-ripple-surface" data-mdc-auto-init="MDCRipple">           <a href="/archives">归档</a></div></nav></div></header><div id="content-outer"><div id="content-inner"><div class="main-post"><article id="post"><h1>Vue双向绑定的理解</h1><h6 class="mdc-typography--subtitle1 row"><div class="post-data"><i class="material-icons mdc-chip__icon mdc-chip__icon--leading">date_range </i><span>2019-05-03</span></div></h6><p>如今的面试题越来越浮夸了，恨不得把造火箭的每个工序每个零件都问出来，然后上着日复一日，年复一年拧螺丝的班，可能到离职，干的活难度都没有面试的大。</p>
<p>随着 vue 框架国内越来越火，这方面的面试题越来越多，尤其是双向绑定的思想，这个东西其实了解一下就可以，可有些竟然让手写一个双向绑定出来，这就有点扯了，我就想问一句，贵公司哪个业务场景要用到手写双向绑定？</p>
<p>说实话双向绑定的实现我是不愿意研究的，原理就那点东西，还不如看看源码来的实在。只是 es6 有个 proxy 的属性成功引起了我的注意，而 vue 3 使用这个玩意实现了双向绑定这块。于是我暂且研究一番。</p>
<p>查阅 <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Proxy" target="_blank" rel="noopener">MDN</a>，发现这个东西可以通过属性查找数组中的特定对象，还能用新的构造函数来扩展一个旧的构造函数……很多功能，用来劫持对象实现双向绑定简直小菜一碟：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">id</span>=<span class="string">"base"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"change"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> obj = &#123;</span></span><br><span class="line">            value: 0</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"><span class="javascript">        <span class="comment">// 使用对象代理</span></span></span><br><span class="line"><span class="javascript">        <span class="keyword">let</span> proxyObj = <span class="keyword">new</span> <span class="built_in">Proxy</span>(obj, &#123;            </span></span><br><span class="line">            /* 在给代理设置值的时候触发,参数含义：</span><br><span class="line"><span class="javascript">            target: 指代使用 <span class="built_in">Proxy</span> 包装的 obj 对象</span></span><br><span class="line">            key：设置的属性名</span><br><span class="line">            value: 设置的新属性值</span><br><span class="line">            receiver: 最初被调用的对象</span><br><span class="line">            */</span><br><span class="line"><span class="javascript">            <span class="keyword">set</span>: function (target, key, value, receiver) &#123;</span></span><br><span class="line"><span class="javascript">                <span class="comment">// 静态方法，一般和 Proxy 的静态方法相对应</span></span></span><br><span class="line"><span class="javascript">                <span class="built_in">Reflect</span>.set(target, key, value, receiver)</span></span><br><span class="line"><span class="javascript">                <span class="built_in">document</span>.getElementById(<span class="string">'base'</span>).value = value</span></span><br><span class="line"><span class="javascript">                <span class="built_in">document</span>.getElementById(<span class="string">'change'</span>).textContent = value</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line"><span class="javascript">        <span class="comment">// 监听键盘事件触发更改</span></span></span><br><span class="line"><span class="javascript">        <span class="built_in">document</span>.addEventListener(<span class="string">'keyup'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span></span><br><span class="line">            proxyObj.value = e.target.value</span><br><span class="line">        &#125;)</span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>相对于使用 Object.defineProperty ，Proxy 解决了老生常谈的监测不到数组改变的尴尬问题。在此之上构建的新版 vue 肯定相对老版本要省掉这块兼容的代码，效率提升是必然的。</p>
<div id="paginator"></div><span class="leancloud-visitors" id="uncategorized/Vue-two-way-binding/index.html" data-flag-title="Vue双向绑定的理解"><em class="post-meta-item-text">阅读量 </em><i class="leancloud-visitors-count">1000000+</i></span><div id="valine"> </div></article><nav id="postnav"></nav></div></div></div><div id="bottom-outer"><h6 class="mdc-typography--subtitle1">©POWERED BY HEXO | THEME: XUKAI</h6><button class="mdc-fab" id="gotop" aria-label="arrow_upward" data-mdc-auto-init="MDCRipple"><span class="mdc-fab__icon material-icons">arrow_upward</span></button></div><script src="https://cdn.bootcss.com/material-components-web/2.3.1/material-components-web.min.js"></script><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="/js/Valine.min.js"></script><script src="/js/common.js"></script></body></html>